# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами
## Описание архитектуры

Приложение разделено на три основных слоя, что обеспечивает изолированность, единственность ответственности и масштабируемость.

### Слой Модели (Model)
Отвечает за хранение, валидацию и модификацию данных приложения, а также за взаимодействие с сервером.

*   **Класс `AppState` (Модель состояния приложения)**
    *   **Назначение:** Хранит текущее состояние всего приложения: список товаров, содержимое корзины, выбранный товар, данные заказа.
    *   **Конструктор:** Принимает экземпляр `EventEmitter` для уведомления об изменениях состояния.
    *   **Поля:**
        *   `catalog: IProduct[]` - массив товаров, полученных с сервера.
        *   `basket: IProduct[]` - массив товаров, добавленных в корзину.
        *   `preview: string | null` - id товара, который currently просматривается в модальном окне.
        *   `order: IOrder` - объект, содержащий данные заказа (адрес, способ оплаты, контакты).
    *   **Методы:**
        *   `setCatalog(items: IProduct[])` - сохраняет массив товаров в состояние и инициирует событие `'items:changed'`.
        *   `getBasket(): IProduct[]` - возвращает текущее содержимое корзину.
        *   `addToBasket(product: IProduct)` - добавляет товар в корзину, обновляет состояние и инициирует событие `'basket:changed'`.
        *   `removeFromBasket(id: string)` - удаляет товар из корзины по id, обновляет состояние и инициирует событие `'basket:changed'`.
        *   `clearBasket()` - очищает корзину и инициирует событие `'basket:changed'`.
        *   `getTotalPrice()` - вычисляет и возвращает общую стоимость товаров в корзине.
        *   `setPreview(id: string)` - устанавливает id товара для предпросмотра.
        *   `setOrderField(field: keyof IOrder, value: string)` - устанавливает значение для поля заказа.

*   **Класс `APIClient` (Наследник от `Api`)**
    *   **Назначение:** Обеспечивает асинхронное взаимодействие с backend API.
    *   **Методы:**
        *   `getProductList(): Promise<IProduct[]>` - запрашивает список товаров.
        *   `orderProducts(order: IOrder): Promise<IOrderResult>` - отправляет данные заказа на сервер.

### Слой Представления (View)
Отвечает за отображение данных пользователю и обработку пользовательского ввода.

*   **Базовый класс `Component<T>`**
    *   **Назначение:** Абстрактный базовый класс для всех компонентов.
    *   **Конструктор:** Принимает `container: HTMLElement` и `events?` (опциональный объект с обработчиками событий).
    *   **Методы:**
        *   `render(container?: HTMLElement): HTMLElement` - рендерит компонент.
        *   `setData(data: Partial<T>)` - абстрактный метод для установки данных.

*   **Класс `Page`**
    *   **Назначение:** Главный компонент, представляющий всю страницу.
    *   **Поля:** Ссылки на DOM-элементы: `gallery`, `basketCounter`, `modal`.

*   **Класс `Card` (Наследник от `Component<IProduct>`)**
    *   **Назначение:** Отображает карточку товара в каталоге.
    *   **Генерируемые события:** `'card:select'` (при клике на карточку).

*   **Класс `CardPreview` (Наследник от `Component<IProduct>`)**
    *   **Назначение:** Отображает полную информацию о товаре в модальном окне.
    *   **Генерируемые события:** `'card:add'` (при клике на кнопку "В корзину").

*   **Класс `Basket` (Наследник от `Component`)**
    *   **Назначение:** Отображает содержимое корзины в модальном окне.
    *   **Генерируемые события:** `'basket:delete'`, `'basket:order'`.

*   **Класс `OrderForm` (Наследник от `Component<IOrder>`)**
    *   **Назначение:** Отображает и валидирует форму ввода данных для доставки.
    *   **Генерируемые события:** `'order:submit'`.

*   **Класс `ContactsForm` (Наследник от `Component<IOrder>`)**
    *   **Назначение:** Отображает и валидирует форму ввода контактных данных.
    *   **Генерируемые события:** `'contacts:submit'`.

*   **Класс `Success` (Наследник от `Component<IOrderResult>`)**
    *   **Назначение:** Отображает сообщение об успешном оформлении заказа.

*   **Класс `Modal`**
    *   **Назначение:** Управляет отображением модального окна.
    *   **Методы:** `open(content: HTMLElement)`, `close()`.

### Слой Презентера (Presenter)
Связывает Model и View. Подписывается на события от View и Model, обрабатывает бизнес-логику.

Код презентера размещен в основном файле приложения (`src/index.ts`).

### Взаимодействие на примере добавления товара в корзину
1.  **View:** Пользователь кликает на кнопку "В корзину" в `CardPreview`. Генерируется событие `'card:add'`.
2.  **Presenter:** Презентер получает `id` товара и вызывает метод Модели `appState.addToBasket(id)`.
3.  **Model:** Модель добавляет товар в корзину и генерирует событие `'basket:changed'`.
4.  **Presenter:** Презентер обновляет вид корзины и счетчик товаров.
5.  **View:** Компоненты перерисовываются с актуальными данными.

## Типы данных

Описание всех интерфейсов и типов данных находится в файле `src/types/index.ts`.
## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
